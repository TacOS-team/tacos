\hypertarget{vmm_8c}{\section{Référence du fichier kernel/vmm.c}
\label{vmm_8c}\index{kernel/vmm.\-c@{kernel/vmm.\-c}}
}
{\ttfamily \#include $<$memory.\-h$>$}\\*
{\ttfamily \#include $<$pagination.\-h$>$}\\*
{\ttfamily \#include $<$vmm.\-h$>$}\\*
{\ttfamily \#include $<$ksyscall.\-h$>$}\\*
{\ttfamily \#include $<$kstdio.\-h$>$}\\*
{\ttfamily \#include $<$scheduler.\-h$>$}\\*
Graphe des dépendances par inclusion de vmm.\-c\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{vmm_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{vmm_8c_a3b45eae19437de2668526d0ffd4b36dd}{\#define {\bfseries P\-T\-E\-\_\-\-M\-A\-G\-I\-C}~0x\-F\-F\-C00000}\label{vmm_8c_a3b45eae19437de2668526d0ffd4b36dd}

\item 
\hypertarget{vmm_8c_a0411770681f0fac662bc86c42aa59d69}{\#define {\bfseries P\-D\-E\-\_\-\-M\-A\-G\-I\-C}~0x\-F\-F\-F\-F\-F000}\label{vmm_8c_a0411770681f0fac662bc86c42aa59d69}

\end{DoxyCompactItemize}
\subsection*{Fonctions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{vmm_8c_afec707c94cbac3d19ac985be2419efae}{struct \hyperlink{structpage__directory__entry}{page\-\_\-directory\-\_\-entry} $\ast$ {\bfseries get\-\_\-pde} (int dir)}\label{vmm_8c_afec707c94cbac3d19ac985be2419efae}

\item 
\hypertarget{vmm_8c_a2b8567beb8e915a4313dc7d0706687b4}{struct \hyperlink{structpage__table__entry}{page\-\_\-table\-\_\-entry} $\ast$ {\bfseries get\-\_\-pte} (int dir, int table)}\label{vmm_8c_a2b8567beb8e915a4313dc7d0706687b4}

\item 
\hypertarget{vmm_8c_ae55ef35e3be343419b2267fbb2f664f3}{\hyperlink{types_8h_a53428b953a0ae6fba02a5b3596c867e0}{vaddr\-\_\-t} {\bfseries get\-\_\-linear\-\_\-address} (int dir, int table, int offset)}\label{vmm_8c_ae55ef35e3be343419b2267fbb2f664f3}

\item 
\hypertarget{vmm_8c_aed7855b392283571ac42224cb840b754}{int {\bfseries map} (\hyperlink{types_8h_a9f047c1f0917f6184a7a013d4b4277a6}{paddr\-\_\-t} phys\-\_\-page\-\_\-addr, \hyperlink{types_8h_a53428b953a0ae6fba02a5b3596c867e0}{vaddr\-\_\-t} virt\-\_\-page\-\_\-addr, int u\-\_\-s)}\label{vmm_8c_aed7855b392283571ac42224cb840b754}

\item 
\hypertarget{vmm_8c_a7326abebbbaf3dfc84414d7ed3097ed9}{void {\bfseries unmap} (\hyperlink{types_8h_a53428b953a0ae6fba02a5b3596c867e0}{vaddr\-\_\-t} virt\-\_\-page\-\_\-addr)}\label{vmm_8c_a7326abebbbaf3dfc84414d7ed3097ed9}

\item 
void \hyperlink{vmm_8c_a99b3ba454c13cfdb437fcaadd1cd3e97}{init\-\_\-vmm} (struct \hyperlink{structvirtual__mem}{virtual\-\_\-mem} $\ast$kvm)
\item 
\hypertarget{vmm_8c_ab0e0fd30967b0927b223ea3c6eb8b72a}{void {\bfseries init\-\_\-process\-\_\-vm} (struct \hyperlink{structvirtual__mem}{virtual\-\_\-mem} $\ast$vm, int init\-\_\-nb\-\_\-pages)}\label{vmm_8c_ab0e0fd30967b0927b223ea3c6eb8b72a}

\item 
unsigned int \hyperlink{vmm_8c_aa6984df26426c14049065875c6b85e9c}{allocate\-\_\-new\-\_\-page} (struct \hyperlink{structvirtual__mem}{virtual\-\_\-mem} $\ast$vm, void $\ast$$\ast$alloc, int u\-\_\-s)
\begin{DoxyCompactList}\small\item\em Allocation d'une nouvelle page. \end{DoxyCompactList}\item 
unsigned int \hyperlink{vmm_8c_a042a3049e6bc33c07f2b2c2a9dcfe78b}{allocate\-\_\-new\-\_\-pages} (struct \hyperlink{structvirtual__mem}{virtual\-\_\-mem} $\ast$vm, unsigned int nb\-\_\-pages, void $\ast$$\ast$alloc, int u\-\_\-s)
\begin{DoxyCompactList}\small\item\em Alloue nb\-\_\-pages pages qui sont placé en espace contigüe de la mémoire virtuelle. \end{DoxyCompactList}\item 
\hypertarget{vmm_8c_aebd98fed59e0c1376fe6952ec2d063c4}{int {\bfseries unallocate\-\_\-page} (struct \hyperlink{structvirtual__mem}{virtual\-\_\-mem} $\ast$vm, void $\ast$page)}\label{vmm_8c_aebd98fed59e0c1376fe6952ec2d063c4}

\item 
\hypertarget{vmm_8c_a9b15e99fd34b3e01cdfae1d5c877ea0c}{void {\bfseries vmm\-\_\-print\-\_\-heap} (struct \hyperlink{structvirtual__mem}{virtual\-\_\-mem} $\ast$vm)}\label{vmm_8c_a9b15e99fd34b3e01cdfae1d5c877ea0c}

\item 
void \hyperlink{vmm_8c_a8a8d898de5c72c3b55b845d19ec32172}{sys\-\_\-vmm} (\hyperlink{types_8h_a33594304e786b158f3fb30289278f5af}{uint32\-\_\-t} min\-\_\-size, void $\ast$$\ast$alloc, \hyperlink{types_8h_a29d85914ddff32967d85ada69854206d}{size\-\_\-t} $\ast$real\-\_\-alloc\-\_\-size)
\item 
\hypertarget{vmm_8c_ade03970596f39a143387325dd835d2c4}{\hyperlink{types_8h_a9f047c1f0917f6184a7a013d4b4277a6}{paddr\-\_\-t} {\bfseries vmm\-\_\-get\-\_\-page\-\_\-paddr} (\hyperlink{types_8h_a53428b953a0ae6fba02a5b3596c867e0}{vaddr\-\_\-t} vaddr)}\label{vmm_8c_ade03970596f39a143387325dd835d2c4}

\item 
\hypertarget{vmm_8c_abf9022ad1609a6a896bd75311896c670}{unsigned int {\bfseries calculate\-\_\-min\-\_\-pages} (\hyperlink{types_8h_a29d85914ddff32967d85ada69854206d}{size\-\_\-t} size)}\label{vmm_8c_abf9022ad1609a6a896bd75311896c670}

\end{DoxyCompactItemize}


\subsection{Description détaillée}
\begin{DoxyAuthor}{Auteur}
Tac\-O\-S developers
\end{DoxyAuthor}
\hypertarget{vmm_8c_LICENSE}{}\subsection{L\-I\-C\-E\-N\-S\-E}\label{vmm_8c_LICENSE}
Copyright (C) 2010, 2011, 2012, 2013 -\/ Tac\-O\-S developers.

This program is free software; you can redistribute it and/or modify it under the terms of the G\-N\-U General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\-I\-T\-H\-O\-U\-T A\-N\-Y W\-A\-R\-R\-A\-N\-T\-Y; without even the implied warranty of M\-E\-R\-C\-H\-A\-N\-T\-A\-B\-I\-L\-I\-T\-Y or F\-I\-T\-N\-E\-S\-S F\-O\-R A P\-A\-R\-T\-I\-C\-U\-L\-A\-R P\-U\-R\-P\-O\-S\-E. See the G\-N\-U General Public License for more details at \href{http://www.gnu.org/copyleft/gpl.html}{\tt http\-://www.\-gnu.\-org/copyleft/gpl.\-html}

You should have received a copy of the G\-N\-U General Public License along with this program; if not, see \href{http://www.gnu.org/licenses}{\tt http\-://www.\-gnu.\-org/licenses}.\hypertarget{vmm_8c_DESCRIPTION}{}\subsection{D\-E\-S\-C\-R\-I\-P\-T\-I\-O\-N}\label{vmm_8c_DESCRIPTION}
vmm est l'allocateur qui s'occupe de gérer les pages virtuelles du noyau. Il se base sur l'algorithme first fit (premier emplacement de taille suffisante)

Maintien la liste des espaces libres et des espaces occupés (slabs). 

\subsection{Documentation des fonctions}
\hypertarget{vmm_8c_aa6984df26426c14049065875c6b85e9c}{\index{vmm.\-c@{vmm.\-c}!allocate\-\_\-new\-\_\-page@{allocate\-\_\-new\-\_\-page}}
\index{allocate\-\_\-new\-\_\-page@{allocate\-\_\-new\-\_\-page}!vmm.c@{vmm.\-c}}
\subsubsection[{allocate\-\_\-new\-\_\-page}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int allocate\-\_\-new\-\_\-page (
\begin{DoxyParamCaption}
\item[{struct {\bf virtual\-\_\-mem} $\ast$}]{vm, }
\item[{void $\ast$$\ast$}]{alloc, }
\item[{int}]{u\-\_\-s}
\end{DoxyParamCaption}
)}}\label{vmm_8c_aa6984df26426c14049065875c6b85e9c}

\begin{DoxyParams}{Paramètres}
{\em vm} & \\
\hline
{\em alloc} & \\
\hline
{\em u\-\_\-s} & 1 si accessible en userspace, 0 sinon.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Renvoie}

\end{DoxyReturn}


Voici le graphe d'appel pour cette fonction \-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=322pt]{vmm_8c_aa6984df26426c14049065875c6b85e9c_cgraph}
\end{center}
\end{figure}


\hypertarget{vmm_8c_a042a3049e6bc33c07f2b2c2a9dcfe78b}{\index{vmm.\-c@{vmm.\-c}!allocate\-\_\-new\-\_\-pages@{allocate\-\_\-new\-\_\-pages}}
\index{allocate\-\_\-new\-\_\-pages@{allocate\-\_\-new\-\_\-pages}!vmm.c@{vmm.\-c}}
\subsubsection[{allocate\-\_\-new\-\_\-pages}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int allocate\-\_\-new\-\_\-pages (
\begin{DoxyParamCaption}
\item[{struct {\bf virtual\-\_\-mem} $\ast$}]{vm, }
\item[{unsigned int}]{nb\-\_\-pages, }
\item[{void $\ast$$\ast$}]{alloc, }
\item[{int}]{u\-\_\-s}
\end{DoxyParamCaption}
)}}\label{vmm_8c_a042a3049e6bc33c07f2b2c2a9dcfe78b}

\begin{DoxyParams}{Paramètres}
{\em vm} & \\
\hline
{\em nb\-\_\-pages} & \\
\hline
{\em alloc} & \\
\hline
{\em u\-\_\-s} & 1 si accessible en userspace, 0 sinon.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Renvoie}

\end{DoxyReturn}


Voici le graphe des appelants de cette fonction \-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{vmm_8c_a042a3049e6bc33c07f2b2c2a9dcfe78b_icgraph}
\end{center}
\end{figure}


\hypertarget{vmm_8c_a99b3ba454c13cfdb437fcaadd1cd3e97}{\index{vmm.\-c@{vmm.\-c}!init\-\_\-vmm@{init\-\_\-vmm}}
\index{init\-\_\-vmm@{init\-\_\-vmm}!vmm.c@{vmm.\-c}}
\subsubsection[{init\-\_\-vmm}]{\setlength{\rightskip}{0pt plus 5cm}void init\-\_\-vmm (
\begin{DoxyParamCaption}
\item[{struct {\bf virtual\-\_\-mem} $\ast$}]{kvm}
\end{DoxyParamCaption}
)}}\label{vmm_8c_a99b3ba454c13cfdb437fcaadd1cd3e97}
Initialisation de la V\-M\-M.


\begin{DoxyParams}{Paramètres}
{\em kvm} & \\
\hline
\end{DoxyParams}


Voici le graphe d'appel pour cette fonction \-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=292pt]{vmm_8c_a99b3ba454c13cfdb437fcaadd1cd3e97_cgraph}
\end{center}
\end{figure}


\hypertarget{vmm_8c_a8a8d898de5c72c3b55b845d19ec32172}{\index{vmm.\-c@{vmm.\-c}!sys\-\_\-vmm@{sys\-\_\-vmm}}
\index{sys\-\_\-vmm@{sys\-\_\-vmm}!vmm.c@{vmm.\-c}}
\subsubsection[{sys\-\_\-vmm}]{\setlength{\rightskip}{0pt plus 5cm}void sys\-\_\-vmm (
\begin{DoxyParamCaption}
\item[{{\bf uint32\-\_\-t}}]{min\-\_\-size, }
\item[{void $\ast$$\ast$}]{alloc, }
\item[{{\bf size\-\_\-t} $\ast$}]{real\-\_\-alloc\-\_\-size}
\end{DoxyParamCaption}
)}}\label{vmm_8c_a8a8d898de5c72c3b55b845d19ec32172}
Syscall V\-M\-M pour allouer des pages. 

Voici le graphe d'appel pour cette fonction \-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=282pt]{vmm_8c_a8a8d898de5c72c3b55b845d19ec32172_cgraph}
\end{center}
\end{figure}


