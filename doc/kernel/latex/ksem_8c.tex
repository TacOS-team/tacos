\hypertarget{ksem_8c}{\section{\-Référence du fichier kernel/ksem.c}
\label{ksem_8c}\index{kernel/ksem.\-c@{kernel/ksem.\-c}}
}


\-Gestion des sémaphores.  


{\ttfamily \#include $<$ksem.\-h$>$}\*
{\ttfamily \#include $<$kprocess.\-h$>$}\*
{\ttfamily \#include $<$kmalloc.\-h$>$}\*
{\ttfamily \#include $<$scheduler.\-h$>$}\*
\-Graphe des dépendances par inclusion de ksem.\-c\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ksem_8c__incl}
\end{center}
\end{figure}
\subsection*{\-Structures de données}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct__sem__fifo__cell}{\-\_\-sem\-\_\-fifo\-\_\-cell}
\item 
struct \hyperlink{structsem__fifo}{sem\-\_\-fifo}
\item 
struct \hyperlink{structsem__t}{sem\-\_\-t}
\end{DoxyCompactItemize}
\subsection*{\-Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{ksem_8c_a46da1a6c3b3ed4c9926f422ff2739682}{\#define {\bfseries \-F\-I\-F\-O\-\_\-\-M\-A\-X\-\_\-\-S\-I\-Z\-E}~32}\label{ksem_8c_a46da1a6c3b3ed4c9926f422ff2739682}

\item 
\hypertarget{ksem_8c_a90160a50ad7f0c2c2da0743933744188}{\#define {\bfseries \-M\-A\-X\-\_\-\-S\-E\-M}~255}\label{ksem_8c_a90160a50ad7f0c2c2da0743933744188}

\item 
\hypertarget{ksem_8c_a34813dd4352a423334c8c44ecbe8eecf}{\#define {\bfseries \-K\-S\-E\-M\-\_\-\-G\-E\-T}~1}\label{ksem_8c_a34813dd4352a423334c8c44ecbe8eecf}

\item 
\hypertarget{ksem_8c_a98aacd763caf46bf89bbee8d0daf196e}{\#define {\bfseries \-K\-S\-E\-M\-\_\-\-C\-R\-E\-A\-T\-E}~2}\label{ksem_8c_a98aacd763caf46bf89bbee8d0daf196e}

\item 
\hypertarget{ksem_8c_a485d63b9002d3b7c69b778eddd7270d2}{\#define {\bfseries \-K\-S\-E\-M\-\_\-\-D\-E\-L}~3}\label{ksem_8c_a485d63b9002d3b7c69b778eddd7270d2}

\item 
\hypertarget{ksem_8c_ad352fc4cad6b104c8a663959320e91a0}{\#define {\bfseries \-K\-S\-E\-M\-\_\-\-P}~4}\label{ksem_8c_ad352fc4cad6b104c8a663959320e91a0}

\item 
\hypertarget{ksem_8c_a1fa1d3274d3ba8f120ed3223f389bceb}{\#define {\bfseries \-K\-S\-E\-M\-\_\-\-V}~5}\label{ksem_8c_a1fa1d3274d3ba8f120ed3223f389bceb}

\item 
\hypertarget{ksem_8c_ac339db638df2c5eda25c0d44876b4b09}{\#define {\bfseries \-S\-Y\-S\-\_\-\-S\-E\-M\-C\-T\-L}~8}\label{ksem_8c_ac339db638df2c5eda25c0d44876b4b09}

\end{DoxyCompactItemize}
\subsection*{\-Définitions de type}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{struct__sem__fifo__cell}{\-\_\-sem\-\_\-fifo\-\_\-cell} \hyperlink{ksem_8c_a83e90e3f49b0f7bb4385e0759e1491f8}{sem\-\_\-fifo\-\_\-cell}
\end{DoxyCompactItemize}
\subsection*{\-Fonctions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{ksem_8c_a191f0fb163ab01b5d2041bdd20d6d424}{init\-\_\-semaphores} ()
\begin{DoxyCompactList}\small\item\em \-Initialisation du système des sémaphores. \end{DoxyCompactList}\item 
int \hyperlink{ksem_8c_a7f54885ee2689208328406935525f0a5}{ksemget} (\hyperlink{types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\-\_\-t} key, int flags)
\begin{DoxyCompactList}\small\item\em \-Obtenir ou créer un sémaphore. ksemget retourne un semid propre au processus, associé au sémaphore désigné par key. \end{DoxyCompactList}\item 
\hypertarget{ksem_8c_af980f49354b68b113faee6edd6851bf9}{int \hyperlink{ksem_8c_af980f49354b68b113faee6edd6851bf9}{ksemctl} (\hyperlink{types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\-\_\-t} key, int cmd, void $\ast$res)}\label{ksem_8c_af980f49354b68b113faee6edd6851bf9}

\begin{DoxyCompactList}\small\item\em \-Manipulation d'un sémaphore. ksemctl permet de manipuler un sémaphore (suppression, libération, valeur, etc.) \end{DoxyCompactList}\item 
int \hyperlink{ksem_8c_acfbbd3e3f726b24309758cf6499a8141}{ksem\-P} (\hyperlink{types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\-\_\-t} key)
\begin{DoxyCompactList}\small\item\em \-Opération \-P sur un sémaphore \-Réalise l'opération \-P sur le sémaphore. \-Le processus essaye donc de prendre le sémaphore si il est libre (ie \-Sa valeur des supérieur à 0). \-Si ce n'est pas le cas, il met son pid dans la fifo du sémaphore pour pouvoir être réveillé en temps voulu, et se met en état d'attente. \end{DoxyCompactList}\item 
int \hyperlink{ksem_8c_acf03efb500e930ca996059a6388b528b}{ksem\-V} (\hyperlink{types_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\-\_\-t} key)
\begin{DoxyCompactList}\small\item\em \-Opération \-V sur un sémaphore \-Réalise l'opération \-V sur le sémaphore. \-Le processus libère le sémaphore. \-Si la fifo est vide, il incrémente la valeur du sémaphore. \-Si un processus est présent dans la fifo, il le réveille. \end{DoxyCompactList}\item 
\hyperlink{ksem_8c_a82fb70bceeb23516b8cbdc1bc8f77805}{\-S\-Y\-S\-C\-A\-L\-L\-\_\-\-H\-A\-N\-D\-L\-E\-R3} (sys\-\_\-ksem, \hyperlink{types_8h_a33594304e786b158f3fb30289278f5af}{uint32\-\_\-t} op, \hyperlink{types_8h_a33594304e786b158f3fb30289278f5af}{uint32\-\_\-t} param, int $\ast$ret)
\begin{DoxyCompactList}\small\item\em \-Handler de l'appel système \-S\-Y\-S\-\_\-\-S\-E\-M \-Dans la pratique, sys\-\_\-ksem ne fait qu'exécuter la fonction correspondant à l'opération demandée. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{\-Description détaillée}
\begin{DoxyAuthor}{\-Auteur}
\-Tac\-O\-S developers
\end{DoxyAuthor}
\hypertarget{vmm_8c_LICENSE}{}\subsection{\-L\-I\-C\-E\-N\-S\-E}\label{vmm_8c_LICENSE}
\-Copyright (\-C) 2010, 2011, 2012 -\/ \-Tac\-O\-S developers.

\-This program is free software; you can redistribute it and/or modify it under the terms of the \-G\-N\-U \-General \-Public \-License as published by the \-Free \-Software \-Foundation; either version 3 of the \-License, or (at your option) any later version.

\-This program is distributed in the hope that it will be useful, but \-W\-I\-T\-H\-O\-U\-T \-A\-N\-Y \-W\-A\-R\-R\-A\-N\-T\-Y; without even the implied warranty of \-M\-E\-R\-C\-H\-A\-N\-T\-A\-B\-I\-L\-I\-T\-Y or \-F\-I\-T\-N\-E\-S\-S \-F\-O\-R \-A \-P\-A\-R\-T\-I\-C\-U\-L\-A\-R \-P\-U\-R\-P\-O\-S\-E. \-See the \-G\-N\-U \-General \-Public \-License for more details at \href{http://www.gnu.org/copyleft/gpl.html}{\tt http\-://www.\-gnu.\-org/copyleft/gpl.\-html}

\-You should have received a copy of the \-G\-N\-U \-General \-Public \-License along with this program; if not, see $<$\href{http://www.gnu.org/licenses}{\tt http\-://www.\-gnu.\-org/licenses}$>$.\hypertarget{vmm_8c_DESCRIPTION}{}\subsection{\-D\-E\-S\-C\-R\-I\-P\-T\-I\-O\-N}\label{vmm_8c_DESCRIPTION}


\subsection{\-Documentation des définitions de type}
\hypertarget{ksem_8c_a83e90e3f49b0f7bb4385e0759e1491f8}{\index{ksem.\-c@{ksem.\-c}!sem\-\_\-fifo\-\_\-cell@{sem\-\_\-fifo\-\_\-cell}}
\index{sem\-\_\-fifo\-\_\-cell@{sem\-\_\-fifo\-\_\-cell}!ksem.c@{ksem.\-c}}
\subsubsection[{sem\-\_\-fifo\-\_\-cell}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf \-\_\-sem\-\_\-fifo\-\_\-cell}  {\bf sem\-\_\-fifo\-\_\-cell}}}\label{ksem_8c_a83e90e3f49b0f7bb4385e0759e1491f8}
\-Cellule d'une fifo. 

\subsection{\-Documentation des fonctions}
\hypertarget{ksem_8c_a191f0fb163ab01b5d2041bdd20d6d424}{\index{ksem.\-c@{ksem.\-c}!init\-\_\-semaphores@{init\-\_\-semaphores}}
\index{init\-\_\-semaphores@{init\-\_\-semaphores}!ksem.c@{ksem.\-c}}
\subsubsection[{init\-\_\-semaphores}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf init\-\_\-semaphores} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{ksem_8c_a191f0fb163ab01b5d2041bdd20d6d424}
\begin{DoxyReturn}{\-Renvoie}
0 
\end{DoxyReturn}
\hypertarget{ksem_8c_a7f54885ee2689208328406935525f0a5}{\index{ksem.\-c@{ksem.\-c}!ksemget@{ksemget}}
\index{ksemget@{ksemget}!ksem.c@{ksem.\-c}}
\subsubsection[{ksemget}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf ksemget} (
\begin{DoxyParamCaption}
\item[{{\bf uint8\-\_\-t}}]{key, }
\item[{int}]{flags}
\end{DoxyParamCaption}
)}}\label{ksem_8c_a7f54885ee2689208328406935525f0a5}
\begin{DoxyReturn}{\-Renvoie}
key en cas de succès, -\/1 sinon. 
\end{DoxyReturn}


\-Voici le graphe des appelants de cette fonction \-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ksem_8c_a7f54885ee2689208328406935525f0a5_icgraph}
\end{center}
\end{figure}


\hypertarget{ksem_8c_acfbbd3e3f726b24309758cf6499a8141}{\index{ksem.\-c@{ksem.\-c}!ksem\-P@{ksem\-P}}
\index{ksem\-P@{ksem\-P}!ksem.c@{ksem.\-c}}
\subsubsection[{ksem\-P}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf ksem\-P} (
\begin{DoxyParamCaption}
\item[{{\bf uint8\-\_\-t}}]{key}
\end{DoxyParamCaption}
)}}\label{ksem_8c_acfbbd3e3f726b24309758cf6499a8141}

\begin{DoxyParams}{\-Paramètres}
{\em key} & \-Identifiant du sémaphore sur lequel l'opération doit être réalisée\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Renvoie}
0 en cas de succès, -\/1 sinon 
\end{DoxyReturn}


\-Voici le graphe d'appel pour cette fonction \-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=270pt]{ksem_8c_acfbbd3e3f726b24309758cf6499a8141_cgraph}
\end{center}
\end{figure}




\-Voici le graphe des appelants de cette fonction \-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=284pt]{ksem_8c_acfbbd3e3f726b24309758cf6499a8141_icgraph}
\end{center}
\end{figure}


\hypertarget{ksem_8c_acf03efb500e930ca996059a6388b528b}{\index{ksem.\-c@{ksem.\-c}!ksem\-V@{ksem\-V}}
\index{ksem\-V@{ksem\-V}!ksem.c@{ksem.\-c}}
\subsubsection[{ksem\-V}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf ksem\-V} (
\begin{DoxyParamCaption}
\item[{{\bf uint8\-\_\-t}}]{key}
\end{DoxyParamCaption}
)}}\label{ksem_8c_acf03efb500e930ca996059a6388b528b}

\begin{DoxyParams}{\-Paramètres}
{\em key} & \-Identifiant du sémaphore sur lequel l'opération doit être réalisée\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Renvoie}
0 en cas de succès, -\/1 sinon 
\end{DoxyReturn}


\-Voici le graphe d'appel pour cette fonction \-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=236pt]{ksem_8c_acf03efb500e930ca996059a6388b528b_cgraph}
\end{center}
\end{figure}




\-Voici le graphe des appelants de cette fonction \-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ksem_8c_acf03efb500e930ca996059a6388b528b_icgraph}
\end{center}
\end{figure}


\hypertarget{ksem_8c_a82fb70bceeb23516b8cbdc1bc8f77805}{\index{ksem.\-c@{ksem.\-c}!\-S\-Y\-S\-C\-A\-L\-L\-\_\-\-H\-A\-N\-D\-L\-E\-R3@{\-S\-Y\-S\-C\-A\-L\-L\-\_\-\-H\-A\-N\-D\-L\-E\-R3}}
\index{\-S\-Y\-S\-C\-A\-L\-L\-\_\-\-H\-A\-N\-D\-L\-E\-R3@{\-S\-Y\-S\-C\-A\-L\-L\-\_\-\-H\-A\-N\-D\-L\-E\-R3}!ksem.c@{ksem.\-c}}
\subsubsection[{\-S\-Y\-S\-C\-A\-L\-L\-\_\-\-H\-A\-N\-D\-L\-E\-R3}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-S\-Y\-S\-C\-A\-L\-L\-\_\-\-H\-A\-N\-D\-L\-E\-R3} (
\begin{DoxyParamCaption}
\item[{sys\-\_\-ksem}]{, }
\item[{{\bf uint32\-\_\-t}}]{op, }
\item[{{\bf uint32\-\_\-t}}]{param, }
\item[{int $\ast$}]{ret}
\end{DoxyParamCaption}
)}}\label{ksem_8c_a82fb70bceeb23516b8cbdc1bc8f77805}

\begin{DoxyParams}{\-Paramètres}
{\em op} & \-Type d'opération à exécuter \\
\hline
{\em param} & \-Dépend du type d'opération \\
\hline
{\em ret} & \-Adresse pour la valeur de retour \\
\hline
\end{DoxyParams}


\-Voici le graphe d'appel pour cette fonction \-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ksem_8c_a82fb70bceeb23516b8cbdc1bc8f77805_cgraph}
\end{center}
\end{figure}


